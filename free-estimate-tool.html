<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Free Moving Estimate Tool</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
body {
    font-family: Arial, sans-serif;
    background: #f5f7fb;
    margin: 0;
    padding: 25px;
    display: flex;
    justify-content: center;
}

/* Wrapper to keep dots + card together */
#wizard-wrapper {
    width: 100%;
    max-width: 480px;
}

/* Step Dots (large bold) */
.step-dots {
    text-align: center;
    font-size: 28px;
    letter-spacing: 14px;
    margin-bottom: 15px;
}
.step-dots span {
    color: #d0d0d0;
}
.step-dots .active {
    color: #2563eb;
}

/* Cards */
.card {
    width: 100%;
    background: #ffffff;
    padding: 25px;
    border-radius: 14px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    display: none;
}

/* Active card visible */
.card.active {
    display: block;
}

/* Slide animations */
.card.slide-from-right {
    animation: slideFromRight 0.3s ease;
}
.card.slide-from-left {
    animation: slideFromLeft 0.3s ease;
}

@keyframes slideFromRight {
    from { opacity: 0; transform: translateX(40px); }
    to   { opacity: 1; transform: translateX(0); }
}
@keyframes slideFromLeft {
    from { opacity: 0; transform: translateX(-40px); }
    to   { opacity: 1; transform: translateX(0); }
}

/* Labels & Inputs */
label {
    font-weight: bold;
    color: #1e293b;
    margin-top: 15px;
    display: block;
}
input, select, textarea {
    width: 100%;
    padding: 12px;
    margin-top: 6px;
    border-radius: 8px;
    border: 1px solid #cbd5e1;
    font-size: 16px;
}
textarea { height: 80px; }

/* Buttons */
.next-btn, .back-btn, .submit-btn {
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 8px;
    font-size: 17px;
    font-weight: bold;
    cursor: pointer;
    margin-top: 20px;
}
.next-btn {
    background: #2563eb;
    color: white;
}
.next-btn:hover { background: #1e40af; }

.back-btn {
    background: #e2e8f0;
    color: #1e293b;
}
.back-btn:hover { background: #cbd5e1; }

.submit-btn {
    background: #16a34a;
    color: white;
}
.submit-btn:hover { background: #15803d; }

.result-line {
    margin: 8px 0;
    font-size: 17px;
}

.success-message {
    display: none;
    margin-top: 20px;
    padding: 15px;
    background: #d1fae5;
    border-left: 6px solid #10b981;
    border-radius: 8px;
    color: #065f46;
    font-weight: bold;
    font-size: 16px;
}
</style>
</head>

<body>

<div id="wizard-wrapper">

    <!-- STEP DOTS -->
    <div class="step-dots">
        <span id="dot1" class="active">●</span>
        <span id="dot2">●</span>
        <span id="dot3">●</span>
        <span id="dot4">●</span>
    </div>

    <!-- STEP 1 — MOVE DETAILS -->
    <div class="card active" id="step1">
        <h2>Move Details</h2>

        <label>Bedrooms / Rooms</label>
        <input id="rooms" type="number" value="4">

        <label>Estimated Labor Hours</label>
        <input id="laborHours" type="number" value="10">

        <label>Extra Movers Needed</label>
        <input id="extraMovers" type="number" value="0">

        <label>Total Movers</label>
        <input id="movers" type="number" value="2">

        <label>Packing Hours Needed?</label>
        <input id="packingHours" type="number" value="3">

        <label>Piano or Gun Safe?</label>
        <select id="piano">
            <option>No</option>
            <option>Yes</option>
        </select>

        <button class="next-btn" type="button" onclick="nextStep()">Next →</button>
    </div>

    <!-- STEP 2 — LOCATIONS -->
    <div class="card" id="step2">
        <h2>Move Locations</h2>

        <label>From ZIP Code</label>
        <input id="fromZip">

        <label>To ZIP Code</label>
        <input id="toZip">

        <label>Estimated One-Way Miles</label>
        <input id="miles" type="number" value="27">

        <label>One-Way Drive Hours</label>
        <input id="driveHours" type="number" value="0.08">

        <label>Round-Trip Drive Hours</label>
        <input id="roundTrip" type="number" value="0.16">

        <button class="back-btn" type="button" onclick="prevStep()">← Back</button>
        <button class="next-btn" type="button" onclick="nextStep()">Next →</button>
    </div>

    <!-- STEP 3 — ESTIMATE -->
    <div class="card" id="step3">
        <h2>Your Estimate</h2>

        <div class="result-line"><strong>Subtotal Labor:</strong> $<span id="subtotalLabor">0</span></div>
        <div class="result-line"><strong>Fuel Cost:</strong> $<span id="fuelCost">0</span></div>
        <div class="result-line"><strong>Total Before Tax:</strong> $<span id="totalCost">0</span></div>

        <h3>Estimate Range</h3>
        <div class="result-line">Low End: $<span id="lowEnd">0</span></div>
        <div class="result-line">High End: $<span id="highEnd">0</span></div>
        <div class="result-line"><strong>Final Range:</strong> <span id="quoteRange"></span></div>

        <button class="back-btn" type="button" onclick="prevStep()">← Back</button>
        <button class="next-btn" type="button" onclick="nextStep()">Next →</button>
    </div>

    <!-- STEP 4 — SUBMIT -->
    <div class="card" id="step4">
        <h2>Request Your Quote</h2>

        <form id="quoteForm" action="https://formspree.io/f/mzznaayj" method="POST">
            <label>Your Name</label>
            <input name="name" required>

            <label>Phone Number</label>
            <input name="phone" required>

            <label>Email Address</label>
            <input name="email" type="email" required>

            <label>Move Date</label>
            <input name="moveDate" type="date" required>

            <label>Additional Notes</label>
            <textarea name="notes"></textarea>

            <!-- Hidden fields -->
            <input type="hidden" name="fromZip" id="hiddenFromZip">
            <input type="hidden" name="toZip" id="hiddenToZip">
            <input type="hidden" name="rooms" id="hiddenRooms">
            <input type="hidden" name="quoteRange" id="hiddenQuoteRange">

            <button class="submit-btn" type="submit">Submit Request</button>
        </form>

        <div class="success-message" id="successMessage">
            Thank you! Your request was sent. We will contact you shortly.
        </div>

        <button class="back-btn" type="button" onclick="prevStep()">← Back</button>
    </div>
</div>

<script>
let currentStep = 1;

function updateDots() {
    for (let i = 1; i <= 4; i++) {
        document.getElementById("dot" + i).classList.remove("active");
    }
    document.getElementById("dot" + currentStep).classList.add("active");
}

function showStep(step, direction) {
    currentStep = step;
    updateDots();

    // Hide all cards
    for (let i = 1; i <= 4; i++) {
        const card = document.getElementById("step" + i);
        card.classList.remove("active", "slide-from-right", "slide-from-left");
    }

    const newCard = document.getElementById("step" + step);
    newCard.classList.add("active");
    if (direction === "forward") {
        newCard.classList.add("slide-from-right");
    } else if (direction === "back") {
        newCard.classList.add("slide-from-left");
    }
}

function nextStep() {
    recalc();
    if (currentStep < 4) {
        showStep(currentStep + 1, "forward");
    }
}
function prevStep() {
    if (currentStep > 1) {
        showStep(currentStep - 1, "back");
    }
}

/* --- CALCULATION LOGIC --- */
const RATE_LOCAL_2MEN = 130;
const RATE_PACKING = 49;
const RATE_FUEL_UNDER35 = 130;
const RATE_FUEL_OVER35 = 150;
const FUEL_MIN_HOURS = 2;
const PIANO_FEE = 150;

const roomsInput = document.getElementById("rooms");
const laborHoursInput = document.getElementById("laborHours");
const packingHoursInput = document.getElementById("packingHours");
const pianoInput = document.getElementById("piano");
const milesInput = document.getElementById("miles");
const roundTripInput = document.getElementById("roundTrip");
const fromZipInput = document.getElementById("fromZip");
const toZipInput = document.getElementById("toZip");
const moversInput = document.getElementById("movers");

const subtotalLabor = document.getElementById("subtotalLabor");
const fuelCostSpan = document.getElementById("fuelCost");
const totalCost = document.getElementById("totalCost");
const lowEnd = document.getElementById("lowEnd");
const highEnd = document.getElementById("highEnd");
const quoteRangeSpan = document.getElementById("quoteRange");

const hiddenFromZip = document.getElementById("hiddenFromZip");
const hiddenToZip = document.getElementById("hiddenToZip");
const hiddenRooms = document.getElementById("hiddenRooms");
const hiddenQuoteRange = document.getElementById("hiddenQuoteRange");

function recalc() {
    let movers = parseFloat(moversInput.value) || 0;
    let laborHours = parseFloat(laborHoursInput.value) || 0;
    let packingHours = parseFloat(packingHoursInput.value) || 0;
    let piano = pianoInput.value;
    let miles = parseFloat(milesInput.value) || 0;
    let roundTrip = parseFloat(roundTripInput.value) || 0;

    let laborCost = laborHours * movers * RATE_LOCAL_2MEN;
    let packingCost = packingHours * RATE_PACKING;
    let pianoCost = piano === "Yes" ? PIANO_FEE : 0;
    let subtotal = laborCost + packingCost + pianoCost;

    let fuelCost = 0;
    if (miles < 35) {
        let billableHours = Math.max(roundTrip, FUEL_MIN_HOURS);
        fuelCost = billableHours * RATE_FUEL_UNDER35;
    } else {
        fuelCost = roundTrip * RATE_FUEL_OVER35;
    }

    let total = subtotal + fuelCost;
    let low = Math.round(total * 0.95);
    let high = Math.round(total * 1.25);
    let range = `$${low} – $${high}`;

    subtotalLabor.innerText = subtotal.toFixed(0);
    fuelCostSpan.innerText = fuelCost.toFixed(0);
    totalCost.innerText = total.toFixed(0);
    lowEnd.innerText = low;
    highEnd.innerText = high;
    quoteRangeSpan.innerText = range;

    hiddenFromZip.value = fromZipInput.value;
    hiddenToZip.value = toZipInput.value;
    hiddenRooms.value = roomsInput.value;
    hiddenQuoteRange.value = range;
}

document.querySelectorAll("input, select")
    .forEach(el => el.addEventListener("input", recalc));

recalc();

/* Form submission */
document.getElementById("quoteForm")
    .addEventListener("submit", async function (e) {
        e.preventDefault();
        const response = await fetch(e.target.action, {
            method: "POST",
            body: new FormData(e.target),
            headers: { Accept: "application/json" }
        });
        if (response.ok) {
            document.getElementById("successMessage").style.display = "block";
            e.target.reset();
        }
    });
</script>

</body>
</html>
